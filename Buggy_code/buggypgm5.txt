import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.linearmodel import LinearRegression
from sklearn.metrics import mean_squared_error

data = pd.DataFrame({
    "Hours_Studied": [2, 4, 5, 6, 8, 1, 3, 7],
    "Sleep_Hours": [7, 6, 5, 6, 8, 7, 5, 4],
    "Score": [50, 60, 65, 70, 85, 40, 55, 75]
})

data.loc[2, "Hours_Studied"] = None 

X = data[["Hours_Studied","Sleep_Hours"]]
y = data["Score"]

scaler = StandardScaler()
X_scaled = scaler.fit_transform(X) 

X_train, X_test, y_train, y_test = train_test_split(X_scaled, y, test_size=0.25)

model = LinearRegression()
model.fit(X_test, y_test) 

y_pred = model.predict(X_train) 

y_pred = [str(val) for val in y_pred]
rmse = mean_squared_error(y_train, y_pred) ** 0.5 

print("Predictions:", y_pred)
print("RMSE:", rmse)

import pickle
f = open("student_model.pkl", "w")
pickle.dump(model, f)

f2 = open("student_model.pkl", "r")
loaded_model = pickle.load(f2)

new_data = np_array([5, 6])
new_scaled = scaler.transform(new_data)
print("Prediction for new student:", loaded_model.predict(new_scaled))